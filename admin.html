<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Creador de Cat√°logo Samsung</title>
    <!-- Fonts -->
    <link rel="stylesheet" href="style.css">
    <!-- Admin Styles -->
    <link rel="stylesheet" href="admin.css">
</head>

<body>
    <!-- SIDEBAR -->
    <div class="sidebar">
        <div class="sidebar-logo">
            <span>üîπ</span> Catalog Admin
        </div>

        <div class="nav-item active" data-view="catalogs">
            <span>üìö</span> Cat√°logos
        </div>
        <div class="nav-item" data-view="products">
            <span>üì¶</span> Base de Datos
        </div>
        <div class="nav-item" data-view="config">
            <span>‚öôÔ∏è</span> Variables
        </div>

        <div class="sidebar-footer">
            <!-- Save Status -->
            <div style="padding: 1rem; background: #f8f9fa; border-radius: 8px; margin-bottom: 1rem; border: 1px solid #eee;">
                <div style="font-size: 0.75rem; color: #666; margin-bottom: 0.5rem; font-weight: 600;">ESTADO</div>
                <div id="lastSaveTime" style="font-size: 0.8rem; color: #999;">Sin cambios</div>
            </div>

            <button onclick="window.exportDataJS()" class="btn-primary" style="width: 100%; justify-content: center; font-size: 0.9rem; margin-bottom: 0.5rem;">
                üì• Exportar Data
            </button>

            <button onclick="window.resetData()" style="width: 100%; padding: 0.8rem; background: none; color: #d32f2f; border: 1px solid transparent; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 0.85rem; transition: all 0.2s;" onmouseover="this.style.background='#ffebee'" onmouseout="this.style.background='none'">
                üîÑ Resetear
            </button>
        </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="main-content">

        <!-- CATALOGS VIEW -->
        <div id="catalogsView" class="view-section active">
            <div class="header-actions">
                <div>
                    <h1 class="page-title">Cat√°logos</h1>
                    <p class="page-subtitle">Gestiona y exporta tus cat√°logos por categor√≠a</p>
                </div>
            </div>

            <div class="catalogs-grid" id="catalogsGrid">
                <!-- Catalogs will be injected here -->
            </div>
        </div>

        <!-- CATALOG DETAIL VIEW -->
        <div id="catalogDetailView" class="view-section">
            <div class="header-actions">
                <div style="display: flex; align-items: center; gap: 1rem;">
                    <button class="btn-secondary" onclick="window.backToCatalogs()" style="padding: 0.5rem 1rem; border-radius: 50%; width: 40px; height: 40px; justify-content: center;">
                        ‚Üê
                    </button>
                    <div>
                        <h1 class="page-title" id="catalogDetailTitle">Cat√°logo</h1>
                        <p class="page-subtitle" id="catalogDetailSubtitle">Gestiona los productos</p>
                    </div>
                </div>
                <div>
                    <button class="btn-primary" id="addToCatalogBtn">
                        <span>+</span> Agregar Productos
                    </button>
                </div>
            </div>

            <div class="admin-filters">
                <span style="display: flex; align-items: center; padding: 0 10px; color: #666;">üîç</span>
                <input type="text" class="search-admin" placeholder="Buscar en este cat√°logo..." id="catalogSearch" style="border: none; padding-left: 0;">
            </div>

            <div class="products-table-container">
                <table id="catalogProductsTable">
                    <thead>
                        <tr>
                            <th width="80">Imagen</th>
                            <th>Producto</th>
                            <th>SKU</th>
                            <th>Precio (Bs)</th>
                            <th width="100">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="catalogTableBody">
                        <!-- Rows will be injected by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- PRODUCTS DATABASE VIEW -->
        <div id="productsView" class="view-section">
            <div class="header-actions">
                <div>
                    <h1 class="page-title">Base de Datos</h1>
                    <p class="page-subtitle">Inventario global de todos los productos</p>
                </div>
                <div>
                    <button class="btn-primary" id="addProductBtn">
                        <span>+</span> Nuevo Producto
                    </button>
                </div>
            </div>

            <div class="admin-filters">
                <div style="flex: 1; position: relative;">
                    <input type="text" class="search-admin" placeholder="Buscar por nombre o SKU..." id="adminSearch">
                </div>
                <select class="select-filter" id="categoryFilter">
                    <option value="all">Todas las categor√≠as</option>
                    <option value="smartphones">Smartphones</option>
                    <option value="tablets">Tablets</option>
                    <option value="smartwatches">Smartwatches</option>
                    <option value="buds">Galaxy Buds</option>
                    <option value="laptops">Laptops</option>
                    <option value="monitors">Monitores</option>
                    <option value="televisions">Televisores</option>
                    <option value="washing_machines">Lavadoras</option>
                    <option value="refrigerators">Refrigeradores</option>
                    <option value="kitchen_cleaning">L√≠nea Blanca</option>
                    <option value="accessories">Accesorios</option>
                </select>
            </div>

            <div class="products-table-container" style="overflow-x: auto;">
                <table id="productsTable" style="min-width: 1200px;">
                    <thead>
                        <tr>
                            <th width="40">ID</th>
                            <th width="60">Img</th>
                            <th width="200">Nombre</th>
                            <th width="100">Categor√≠a</th>
                            <th width="80">Precio</th>
                            <th width="80">P. Orig</th>
                            <th width="80">Badge</th>
                            <th width="120">Almacenamiento</th>
                            <th width="250">Variantes</th>
                            <th width="80">Acciones</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody">
                        <!-- Rows will be injected by JS -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- VARIABLES VIEW -->
        <div id="configView" class="view-section">
            <div class="header-actions">
                <div>
                    <h1 class="page-title">Variables Globales</h1>
                    <p class="page-subtitle">Gestiona colores y configuraciones del sistema</p>
                </div>
                <div>
                    <button class="btn-secondary" id="addColorBtn">
                        <span>+</span> Nuevo Color
                    </button>
                    <button class="btn-primary" id="saveVariablesBtn">
                        üíæ Guardar
                    </button>
                </div>
            </div>

            <div style="background: white; padding: 2rem; border-radius: 16px; box-shadow: var(--shadow-sm); border: 1px solid var(--border-color);">
                <div class="admin-filters" style="margin-bottom: 1.5rem; box-shadow: none; border: 1px solid #eee; padding: 0.5rem;">
                    <input type="text" class="search-admin" placeholder="Buscar color..." id="colorSearch" style="border: none;">
                </div>

                <div style="overflow-x: auto;">
                    <table style="font-size: 0.95rem;">
                        <thead>
                            <tr>
                                <th width="200">Nombre del Color</th>
                                <th width="150">C√≥digo Hex</th>
                                <th width="100">Preview</th>
                                <th width="150">Uso</th>
                                <th width="100">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="colorsTableBody">
                            <!-- Color rows will be injected here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- PRODUCT MODAL -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div>
                    <h2 class="modal-title" id="modalTitle">Nuevo Producto</h2>
                    <p style="color: #666; font-size: 0.9rem; margin-top: 4px;">Completa la informaci√≥n del producto</p>
                </div>
                <button class="close-modal" id="closeModal">&times;</button>
            </div>

            <div class="modal-body">
                <form id="productForm">
                    <input type="hidden" id="editProductId">

                    <!-- SECCI√ìN 1: DATOS GENERALES -->
                    <div class="form-section">
                        <div class="form-section-title">
                            <span>üìù</span> Informaci√≥n B√°sica
                        </div>
                        <div class="form-grid">
                            <div class="form-group full-width">
                                <label class="form-label">Nombre del Producto</label>
                                <input type="text" class="form-input" id="prodName" required placeholder="Ej: Galaxy S24 Ultra 5G" style="font-size: 1.1rem; font-weight: 600;">
                            </div>
                            <div class="form-group">
                                <label class="form-label">Categor√≠a</label>
                                <select class="form-select" id="prodCategory" required>
                                    <option value="smartphones">Smartphones</option>
                                    <option value="tablets">Tablets</option>
                                    <option value="smartwatches">Smartwatches</option>
                                    <option value="buds">Galaxy Buds</option>
                                    <option value="laptops">Laptops</option>
                                    <option value="monitors">Monitores</option>
                                    <option value="televisions">Televisores</option>
                                    <option value="washing_machines">Lavadoras</option>
                                    <option value="refrigerators">Refrigeradores</option>
                                    <option value="kitchen_cleaning">L√≠nea Blanca</option>
                                    <option value="accessories">Accesorios</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label class="form-label">Badge / Etiqueta (Opcional)</label>
                                <input type="text" class="form-input" id="prodBadge" placeholder="Ej: Nuevo, Oferta, Best Seller">
                            </div>
                        </div>
                    </div>

                    <!-- SECCI√ìN 2: ALMACENAMIENTO Y PRECIOS -->
                    <div class="form-section">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem; border-bottom: 2px solid #f0f0f0; padding-bottom: 0.8rem;">
                            <div class="form-section-title" style="margin-bottom: 0; border: none; padding: 0;">
                                <span>üè∑Ô∏è</span> Precios y Variantes de Almacenamiento
                            </div>
                            <button type="button" class="btn-secondary" onclick="addStorageRow()" style="padding: 0.4rem 1rem; font-size: 0.85rem;">
                                + Agregar Opci√≥n
                            </button>
                        </div>

                        <div style="background: #f8f9fa; border-radius: 8px; padding: 1px;">
                            <div style="display:grid; grid-template-columns: 2fr 1.5fr 1.5fr 40px; gap:15px; padding: 10px 15px; font-weight:600; font-size:0.8rem; color:#666; text-transform:uppercase;">
                                <div>Capacidad / Modelo</div>
                                <div>Precio Oferta (Bs)</div>
                                <div>Precio Original (Bs)</div>
                                <div></div>
                            </div>
                            <div id="storageContainer" style="padding: 0 10px 10px 10px;">
                                <!-- Rows inserted by JS -->
                            </div>
                        </div>
                        <p style="color:#666; font-size: 0.85rem; margin-top: 10px; display: flex; align-items: center; gap: 5px;">
                            ‚ÑπÔ∏è Si el producto no tiene almacenamiento, deja el campo "Capacidad" vac√≠o y solo pon el precio.
                        </p>
                    </div>

                    <!-- SECCI√ìN 3: VARIANTES Y FOTOS -->
                    <div class="form-section">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem; border-bottom: 2px solid #f0f0f0; padding-bottom: 0.8rem;">
                            <div class="form-section-title" style="margin-bottom: 0; border: none; padding: 0;">
                                <span>üé®</span> Variantes Visuales (Colores)
                            </div>
                            <button type="button" class="btn-secondary" onclick="addRefinedVariantRow()" style="padding: 0.4rem 1rem; font-size: 0.85rem;">
                                + Agregar Variante
                            </button>
                        </div>

                        <div id="variantsContainer">
                            <!-- Variant cards inserted by JS -->
                        </div>
                    </div>
                </form>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="cancelBtn">Cancelar</button>
                <button type="button" class="btn-primary" onclick="document.getElementById('productForm').dispatchEvent(new Event('submit'))">
                    Guardar Producto
                </button>
            </div>
        </div>
    </div>

    <!-- COLOR EDIT MODAL -->
    <div id="colorModal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <div class="modal-header">
                <h2 class="modal-title" id="colorModalTitle">Editar Color</h2>
                <button class="close-modal" id="closeColorModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="colorForm">
                    <input type="hidden" id="editColorOldName">
                    <div class="form-group">
                        <label class="form-label">Nombre del Color</label>
                        <input type="text" class="form-input" id="colorName" required placeholder="Ej: Azul Met√°lico">
                    </div>

                    <div class="form-group">
                        <label class="form-label">C√≥digo Hex</label>
                        <div style="display: flex; gap: 10px; align-items: center;">
                            <input type="text" class="form-input" id="colorHex" required placeholder="#3c5b8a" pattern="^#[0-9A-Fa-f]{6}$" style="font-family: monospace;">
                            <input type="color" id="colorPicker" style="width: 50px; height: 42px; padding: 0; border: none; background: none; cursor: pointer;">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Vista Previa</label>
                        <div id="colorPreview" style="width: 100%; height: 80px; border-radius: 12px; border: 1px solid #eee; box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);"></div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" id="cancelColorBtn">Cancelar</button>
                <button type="button" class="btn-primary" onclick="document.getElementById('colorForm').dispatchEvent(new Event('submit'))">
                    Guardar
                </button>
            </div>
        </div>
    </div>

    <!-- SCRIPTS -->
    <script src="color-variables.js"></script>
    <script src="data.js"></script>
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <script src="admin.js"></script>
</body>

</html>